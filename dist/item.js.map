{"version":3,"sources":["../src/item.js"],"names":["lib","See3D","Library","Item","p","Vector3","Zero","r","position","rotation","LibraryDefineObject","Scene","name","game","items","cameras","use","__name","item","type","c","push","cn","render","noView","ctx","dom","Camera","scene","itemPoints","move","Matrix","TransMoveInverse","i","length","array","entity","planes","Point","size","define","trans","library","load","DEBUG","loadGlobal","global","toSee3D"],"mappings":"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","file":"item.js","sourcesContent":["'bpo enable';\n\n!function () {\n    let lib = new See3D.Library(\"View\");\n\n    class Item extends See3D.LibraryDefineObject {\n        constructor(p = Vector3.Zero(), r = Vector3.Zero()) {\n            super(\"Item\");\n            this.position = p;\n            this.rotation = r;\n        }\n    }\n    class Scene extends See3D.LibraryDefineObject {\n        constructor(name, game) {\n            super(\"Scene\");\n            this.game = game;\n            this.items = [];\n            this.cameras = {};\n            this.use = null;\n            this.__name = name;\n        }\n        get name() {\n            return this.__name;\n        }\n        push(item) {\n            if (item.type == \"Camera\") {\n                let c = item;\n                this.cameras[c.name] = c;\n                if (!this.use) this.use = c;\n            } else {\n                this.items.push(item);\n            }\n            return this;\n        }\n        get ctx() {\n            return this.game.ctx;\n        }\n        get dom() {\n            return this.game.dom;\n        }\n        camera(cn) {\n            this.use = this.cameras[cn];\n            return this;\n        }\n        render() {\n            if (this.use) {\n                this.use.render();\n            } else {\n                this.noView();\n            }\n            return this;\n        }\n        noView() {\n            this.game.noView();\n            return this;\n        }\n    }\n    class Camera extends Item {\n        constructor(p, r, name, scene) {\n            super(p, r);\n            this.type = \"Camera\";\n            this.scene = scene;\n            this.__name = name;\n        }\n        render() {\n            let items = this.scene.items;\n            let ctx = this.scene.ctx;\n            let itemPoints = [];\n            let move = See3D.Matrix.TransMoveInverse(this.position);\n            // console.log(\"update\");\n            for (let i = 0; i < items.length; i++) {\n                let p = items[i].position;\n                p.array.push(1);\n                itemPoints.push(p * move);\n            }\n            return this;\n        }\n        get name() {\n            return this.__name;\n        }\n    }\n\n    class entity extends Item {\n        constructor(p, r, planes) {\n            super(p, r);\n            this.planes = planes;\n        }\n    }\n\n    class Point extends entity {\n        constructor(p = Vector3.Zero(), size = 10) {\n            super(p, Vector3.Zero());\n            this.type = \"Point\";\n            this.r = size;\n        }\n    }\n    // class PlaneView extends Item {\n    //     constructor(p = Vector3.Zero(), r = Vector3.Zero(), points = [], bind) {\n    //         super(p, r);\n    //         this.points = points;\n    //         this.bind = bind;\n    //     }\n    //     trans() {\n    //         let points = [];\n    //         for (let i = 0; i < this.points.length; i++) {\n    //             points.push(new Vector3(this.points[i].x + this.bind.x, this.points[i].y + this.bind.y, this.points[i].z + this.bind.z));\n    //         }\n    //         return points;\n    //     }\n    // }\n    //\n    // let ITEM_CONFIG = {\n    //     \"classes\": {\n    //         \"Cube\": {\n    //             planes: [\n    //             ]\n    //         }\n    //     }\n    // };\n    //\n    // class Cube extends entity {\n    //     constructor(p, s) {\n    //         let planes = [];\n    //         super(p, Vector3.Zero(), [\n    //             new PlaneView(new Vector3(p.x + s.x, p.y, p.z), Vector3.Zero(), [\n    //                 new Vector3(p.x + s.x, p.y + s.y, p.z + s.z),\n    //                 new Vector3(p.x + s.x, p.y + s.y, p.z - s.z),\n    //                 new Vector3(p.x + s.x, p.y - s.y, p.z - s.z),\n    //                 new Vector3(p.x + s.x, p.y - s.y, p.z + s.z),\n    //                 new Vector3(p.x + s.x, p.y + s.y, p.z + s.z),\n    //             ]),\n    //             new PlaneView(new Vector3(p.x, p.y + s.y, p.z), Vector3.Zero(), [\n    //                 new Vector3(p.x - s.x, p.y + s.y, p.z - s.z),\n    //                 new Vector3(p.x - s.x, p.y + s.y, p.z + s.z),\n    //                 new Vector3(p.x + s.x, p.y + s.y, p.z + s.z),\n    //                 new Vector3(p.x + s.x, p.y + s.y, p.z - s.z),\n    //                 new Vector3(p.x - s.x, p.y + s.y, p.z - s.z),\n    //             ]),\n    //             new PlaneView(new Vector3(p.x, p.y, p.z - s.z), Vector3.Zero(), [\n    //                 new Vector3(p.x - s.x, p.y + s.y, p.z - s.z),\n    //                 new Vector3(p.x + s.x, p.y + s.y, p.z - s.z),\n    //                 new Vector3(p.x + s.x, p.y - s.y, p.z - s.z),\n    //                 new Vector3(p.x - s.x, p.y - s.y, p.z - s.z),\n    //                 new Vector3(p.x + s.x, p.y + s.y, p.z - s.z),\n    //             ]),\n    //         ]);\n    //     }\n    // }\n\n    lib.define(\"Item\", Item);// virtual\n\n    lib.define(\"Scene\", Scene);\n    lib.define(\"Camera\", Camera);// renderer\n\n    lib.define(\"entity\", entity);// virtual\n\n    lib.define(\"Point\", Point);\n\n    lib.trans();\n    See3D.library(lib);\n    See3D.load(\"View\");\n    if (See3D.DEBUG) {\n        See3D.loadGlobal(\"Math3D\");// 将库加入浏览器全局\n        lib.global();// 将库API加入浏览器全局\n    }\n    See3D.lib(\"View\");\n    lib.toSee3D();\n}();"]}