{"version":3,"sources":["../../src/item.js"],"names":["See3D","lib","Library","Scene","use","game","items","camera","scene","render","itm","push","ctx","alpha","beta","width","height","Item","position","Math3D","Point3D","Zero","rotation","points","planes","maxRadius","binding","addTo","inverse","i","length","rotate","norm","s","mul_","changeMaxRadius","max","m2","mod2","Math","sqrt","subTo","step","p","x","y","z","left","forward","up","Camera","type","ta","tan","tb","maxLen","NEAR_Z","FAR_Z","screenPlane","Plane3D","item","itemCamPos","transToCameraPosition","abs","PI","transedPoints","transedPlanes","point3d","beginPath","arc","mappingTo","fillStyle","fill","closePath","moveTo","lineTo","strokeStyle","stroke","getPoint","e","console","error","bind","j","c","plane","mul","k","prePoint","needRenderAgain","start","tmppos","count","cpoint","raw","parmline","Parmline3D","intersParmlinePlane","point","itemWorldPoint","add","sub","BaseCamera","FreeCamera","Point2D","$rotation","Point","Line","end","copy","mod","Cube","w","h","d","Pyramid","pointCount","radius","delta_theta","plane_bottom","theta","sin","cos","atan","Platform","radius1","radius2","plane_top","Prism","Cloth","acc","wC","hC","getIndex","cb","call","define","toSee3D","global"],"mappings":"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","file":"item.js","sourcesContent":["!function (See3D) {\n    let lib = new See3D.Library(\"View\");\n\n    class Scene {\n        constructor() {\n            this.use = null;\n            this.game = null;\n            this.items = [ ];\n        }\n        camera(camera) {\n            this.use = camera;\n            camera.scene = this;\n            return this;\n        }\n        render() {\n            if (this.use) this.use.render();\n            return this;\n        }\n        push(itm) {\n            this.items.push(itm);\n            return this;\n        }\n        get ctx() { return this.game.ctx; }\n        get alpha() { return this.game.alpha; }\n        get beta() { return this.game.beta; }\n        get width() { return this.game.width(); }\n        get height() { return this.game.height(); }\n    }\n    class Item {\n        constructor(position = See3D.Math3D.Point3D.Zero(), rotation = new See3D.Math3D.Point3D()) {\n            this.position = position;\n            this.rotation = rotation;\n            this.points = [ ];\n            this.planes = [];\n            this.maxRadius = 0;\n            rotation.binding = this;\n        }\n        rotate(rotation) {\n            this.rotation.addTo(rotation);\n            rotation = rotation.inverse();\n            for (let i = 0; i < this.points.length; i++) {\n                this.points[i] = this.points[i].rotate(rotation);\n            }\n            for (let i = 0; i < this.planes.length; i++) {\n                this.planes[i][this.planes[i].length - 1] = this.planes[i][this.planes[i].length - 1].rotate(rotation).norm();\n            }\n            return this;\n        }\n        scale(s) {\n            for (let i = 0; i < this.points.length; i++) {\n                this.points[i] = this.points[i].mul_(s);\n            }\n            this.changeMaxRadius();\n            return this;\n        }\n        changeMaxRadius() {\n            let max = 0;\n            for (let i = 0; i < this.points.length; i++) {\n                let m2 = this.points[i].mod2();\n                if (m2 > max) max = m2;\n            }\n            this.maxRadius = Math.sqrt(max);\n        }\n        moveOrigin(s) {\n            for (let i = 0; i < this.points.length; i++) {\n                this.points[i].subTo(s);\n            }\n            return this;\n        }\n        forward(step) {\n            let p = (new See3D.Math3D.Point3D(0, 0, step)).rotate(this.rotation.inverse());\n            this.position.x -= p.x;\n            this.position.y -= p.y;\n            this.position.z += p.z;\n            return this;\n        }\n        left(step) {\n            let p = (new See3D.Math3D.Point3D(step, 0, 0)).rotate(this.rotation.inverse());\n            this.position.x -= p.x;\n            this.position.y -= p.y;\n            this.position.z += p.z;\n            return this;\n        }\n        up(step) {\n            let p = (new See3D.Math3D.Point3D(0, step, 0)).rotate(this.rotation.inverse());\n            this.position.x -= p.x;\n            this.position.y -= p.y;\n            this.position.z += p.z;\n            return this;\n        }\n        right(step) {\n            return this.left(-step);\n        }\n        back(step) {\n            return this.forward(-step);\n        }\n        down(step) {\n            return this.up(-step);\n        }\n    }\n    class Camera extends Item {\n        constructor(position, rotation) {\n            super(position, rotation);\n            this.type = \"Camera\";\n            this.scene = null;\n        }\n        render() {\n            let { ctx, alpha, beta, width, height } = this;\n            let ta = Math.tan(alpha / 2);\n            let tb = Math.tan(beta / 2);\n            let maxLen = Math.max(width, height);\n            const NEAR_Z = 0.1, FAR_Z = 1000;\n            let screenPlane = new See3D.Math3D.Plane3D(new See3D.Math3D.Point3D(0, 0, 1), new See3D.Math3D.Point3D(0, 0, NEAR_Z));\n            // console.log(NEAR_Z);\n            let items = this.scene.items;\n            for (let i = 0; i < items.length; i++) {\n                let item = items[i];\n                let points = item.points;\n                let planes = item.planes;\n                let itemCamPos = this.transToCameraPosition(See3D.Math3D.Point3D.Zero(), item.position);\n                if (itemCamPos.z + item.maxRadius <= NEAR_Z || itemCamPos.z + item.maxRadius > FAR_Z) continue;// 近裁面和远裁面的判断\n                if (Math.abs(itemCamPos.x) - item.maxRadius > itemCamPos.z / Math.tan(Math.PI / 2 - beta / 2))\n                    continue;\n                // console.log(Math.tan(Math.PI / 2 - beta / 2) * Math.abs(itemCamPos.z + item.maxRadius * 2));\n                if (Math.abs(itemCamPos.y) - item.maxRadius > itemCamPos.z / Math.tan(Math.PI / 2 - beta / 2))\n                    continue;\n                let transedPoints = { };\n                let transedPlanes = [ ];\n                if (item.type == \"Point\") {\n                    let point3d = this.transToCameraPosition(points[0], item.position);\n                    ctx.beginPath();\n                    ctx.arc(...point3d.mappingTo(ta, tb, maxLen), 1, 0, 2 * Math.PI);\n                    ctx.fillStyle = \"#fff\";\n                    ctx.fill();\n                    ctx.closePath();\n                    continue;\n                } else if (item.type == \"Line\") {\n                    ctx.beginPath();\n                    ctx.moveTo(...this.transToCameraPosition(points[0], item.position).mappingTo(ta, tb, maxLen));\n                    ctx.lineTo(...this.transToCameraPosition(points[1], item.position).mappingTo(ta, tb, maxLen));\n                    ctx.strokeStyle = \"#fff\";\n                    ctx.stroke();\n                    ctx.closePath();\n                    continue;\n                }\n                // for (let j = 0; j < points.length; j++) {\n                //     transedPoints.push(this.transToCameraPosition(points[j], item.position));\n                // }\n                let getPoint = function (i) {\n                    try {\n                        if (transedPoints[i]) return transedPoints[i];\n                        return transedPoints[i] = this.transToCameraPosition(points[i], item.position);\n                    } catch (e) {\n                        console.error(e);\n                        debugger;\n                    }\n                }.bind(this);\n                for (let j = 0, c = 0; j < planes.length; j++) {\n                    let plane = planes[j];\n                    if (plane[plane.length - 1].rotate(this.rotation.inverse()).mul(getPoint(plane[0]).inverse().norm()) < 0) {\n                        continue;\n                    }\n                    transedPlanes.push([]);\n                    for (let k = 0; k < plane.length - 1; k++) {\n                        // console.log(transedPlanes[j], j);\n                        transedPlanes[c].push(getPoint(plane[k]));\n                    }\n                    c++;\n                }\n                // let colorIndex = 0;\n                // let colors = [\"#fff\", \"#f00\", \"#0f0\", \"#00f\", \"#ff0\", \"#0ff\", \"#f0f\"];\n                for (let j = 0; j < transedPlanes.length; j++) {\n                    ctx.beginPath();\n                    let prePoint = transedPlanes[j][0];\n                    let needRenderAgain = false;\n                    let start = 1;\n                    if (prePoint.z < NEAR_Z) {\n                        needRenderAgain = true;\n                        prePoint = transedPlanes[j][1];\n                        start = 2;\n                        while (prePoint && prePoint.z < NEAR_Z)\n                            prePoint = transedPlanes[j][start++];\n                        if (!prePoint) continue;\n                    }\n                    let tmppos = prePoint.mappingTo(ta, tb, maxLen);\n                    let count = transedPlanes[j].length;\n                    ctx.moveTo(...tmppos);\n                    for (let k = start; k < count || (needRenderAgain && !(k = 0) && !(needRenderAgain = false) && (count = start)); k++) {\n                        // if (k == transedPlanes[j].length) {\n                        //     count = start;\n                        //     k = 0;\n                        // }\n                        let cpoint = transedPlanes[j][k];\n                        let raw = cpoint;\n                        if (prePoint.z < NEAR_Z) {\n                            if (cpoint.z < NEAR_Z) {\n                                prePoint = cpoint;\n                                continue;\n                            }\n                            let parmline = new See3D.Math3D.Parmline3D(prePoint, cpoint);\n                            prePoint = See3D.Math3D.intersParmlinePlane(parmline, screenPlane);\n                            ctx.moveTo(...prePoint.mappingTo(ta, tb, maxLen));\n                        }\n                        if (cpoint.z < NEAR_Z) {\n                            let parmline = new See3D.Math3D.Parmline3D(prePoint, cpoint);\n                            cpoint = See3D.Math3D.intersParmlinePlane(parmline, screenPlane);\n                        }\n                        ctx.lineTo(...cpoint.mappingTo(ta, tb, maxLen));\n                        prePoint = raw;\n                    }\n                    ctx.lineTo(...tmppos);\n                    ctx.strokeStyle = \"#fff\";\n                    // ctx.fillStyle = colors[(colorIndex >= colors.length && (colorIndex = 0)) || colorIndex++];\n                    ctx.stroke();\n                    // ctx.fill();\n                    ctx.closePath();\n                }\n            }\n            return this;\n        }\n        transToCameraPosition(point, itemWorldPoint) {\n            return point.add(itemWorldPoint).sub(this.position).rotate(this.rotation.inverse());\n        }\n        get ctx() { return this.scene.ctx; }\n        get alpha() { return this.scene.alpha; }\n        get beta() { return this.scene.beta; }\n        get width() { return this.scene.width; }\n        get height() { return this.scene.height; }\n    }\n    class BaseCamera extends Camera {\n        constructor(position = See3D.Math3D.Point3D.Zero(), rotation = new See3D.Math3D.Point3D()) {\n            super(position, rotation);\n        }\n    }\n    class FreeCamera extends BaseCamera {\n        constructor(position = See3D.Math3D.Point3D.Zero(), rotation = new See3D.Math3D.Point2D()) {\n            super(position);\n            this.$rotation = rotation;\n        }\n        updateRotation() {\n            this.rotation.y = this.$rotation.x;\n            this.rotation.x = Math.PI / 2 - this.$rotation.y;\n            this.rotation.z = this.$rotation.y;\n        }\n    }\n    class Point extends Item {\n        constructor(position = See3D.Math3D.Point3D.Zero(), rotation = new See3D.Math3D.Point3D()) {\n            super(position, rotation);\n            this.type = \"Point\";\n            this.points = [\n                See3D.Math3D.Point3D.Zero()\n            ];\n            this.maxRadius = 0;\n        }\n        changeMaxRadius() { }\n    }\n    class Line extends Item {\n        constructor(position = See3D.Math3D.Point3D.Zero(), start, end) {\n            super(position, new See3D.Math3D.Point3D());\n            this.type = \"Line\";\n            this.points = [\n                start.copy(), end.copy()\n            ];\n            this.maxRadius = start.sub(end).mod();\n        }\n        changeMaxRadius() {\n            this.maxRadius = start.sub(end).mod();\n        }\n    }\n    class Cube extends Item {\n        constructor(position = See3D.Math3D.Point3D.Zero(), {\n            w = 5, h = 5, d = 5\n        } = { }) {\n            super(position, See3D.Math3D.Point3D.Zero());\n            this.type = \"Cube\";\n            this.points = [\n                new See3D.Math3D.Point3D(w, h, d),\n                new See3D.Math3D.Point3D(w, h, -d),\n                new See3D.Math3D.Point3D(w, -h, d),\n                new See3D.Math3D.Point3D(w, -h, -d),\n                new See3D.Math3D.Point3D(-w, h, d),\n                new See3D.Math3D.Point3D(-w, h, -d),\n                new See3D.Math3D.Point3D(-w, -h, d),\n                new See3D.Math3D.Point3D(-w, -h, -d),\n            ];\n            // up: 0, 1, 4, 5\n            this.planes = [\n                [ 1, 2, 3, new Point3D(1, 0, 0) ],\n                [ 0, 1, 2, new Point3D(1, 0, 0) ],\n                [ 5, 6, 7, new Point3D(-1, 0, 0) ],\n                [ 4, 5, 6, new Point3D(-1, 0, 0) ],\n                [ 3, 6, 7, new Point3D(0, -1, 0) ],\n                [ 2, 3, 6, new Point3D(0, -1, 0) ],\n                [ 1, 4, 5, new Point3D(0, 1, 0) ],\n                [ 0, 1, 4, new Point3D(0, 1, 0) ],\n                [ 2, 4, 6, new Point3D(0, 0, 1) ],\n                [ 0, 2, 4, new Point3D(0, 0, 1) ],\n                [ 3, 5, 7, new Point3D(0, 0, -1) ],\n                [ 1, 3, 5, new Point3D(0, 0, -1) ],\n            ];\n            this.maxRadius = Math.sqrt(w ** 2 + h ** 2 + d ** 2);\n        }\n    }\n    class Pyramid extends Item {\n        constructor(position = See3D.Math3D.Point3D.Zero(), {\n            pointCount, radius, height\n        } = { }) {\n            super(position, See3D.Math3D.Point3D.Zero());\n            this.type = \"Pyramid\";\n            this.points = [ new See3D.Math3D.Point3D(0, height / 2, 0) ];\n            this.planes = [];\n            this.maxRadius = Math.max(radius, height);\n            let delta_theta = Math.PI * 2 / pointCount;\n            let plane_bottom = [];\n            let i = 1, theta = 0;\n            for (; i <= pointCount; i++, theta += delta_theta) {\n                this.points.push(new See3D.Math3D.Point3D(radius * Math.sin(theta), -height / 2, radius * Math.cos(theta)));\n                plane_bottom.push(i);\n                this.planes.push([ i === 1 ? pointCount : i - 1, i, 0, (new See3D.Math3D.Point3D(Math.sin(theta - delta_theta / 2), Math.sin(Math.PI / 2 - Math.atan(radius / height)), Math.cos(theta - delta_theta / 2))).norm() ]);\n                // if (i > 0) this.planes.push([ i, i + 1, 0, new See3D.Math3D.Point3D(0, 0, 0) ]);\n            }\n            // this.planes.push([ i + 1, 1, 0, (new See3D.Math3D.Point3D(Math.sin(theta - delta_theta / 2), Math.sin(Math.PI / 2 - Math.atan(radius / height)), Math.cos(theta - delta_theta / 2))).norm() ]);\n            plane_bottom.push(new See3D.Math3D.Point3D(0, -1, 0));\n            this.planes.push(plane_bottom);\n        }\n    }\n    class Platform extends Item {\n        constructor(position = See3D.Math3D.Point3D.Zero(), {\n            pointCount, radius1, radius2, height\n        } = { }) {\n            super(position, See3D.Math3D.Point3D.Zero());\n            this.type = \"Platform\";\n            this.points = [  ];\n            this.planes = [ ];\n            this.maxRadius = Math.max(radius1, radius2, height);\n            let delta_theta = Math.PI * 2 / pointCount;\n            let plane_bottom = [], plane_top = [];\n            let i = 0, theta = 0;\n            for (; i < pointCount; i++, theta += delta_theta) {\n                this.points.push(new See3D.Math3D.Point3D(radius1 * Math.sin(theta), -height / 2, radius1 * Math.cos(theta)));\n                plane_bottom.push(i);\n            }\n            for (theta = 0; i < pointCount << 1; i++, theta += delta_theta) {\n                this.points.push(new See3D.Math3D.Point3D(radius2 * Math.sin(theta), height / 2, radius2 * Math.cos(theta)));\n                plane_top.push(i);\n                this.planes.push([ i, i === pointCount ? (pointCount << 1) - 1 : i - 1, i === pointCount ? pointCount - 1 : i - pointCount - 1, i === pointCount ? 0 : i - pointCount, (new See3D.Math3D.Point3D(Math.sin(theta - delta_theta / 2), Math.cos(Math.PI / 2 - Math.atan((radius1 - radius2) / height)), Math.cos(theta - delta_theta / 2))).norm() ]);\n            }\n            plane_top.push(new See3D.Math3D.Point3D(0, 1, 0));\n            plane_bottom.push(new See3D.Math3D.Point3D(0, -1, 0));\n            this.planes.push(plane_top);\n            this.planes.push(plane_bottom);\n        }\n    }\n    class Prism extends Platform {\n        constructor(position = See3D.Math3D.Point3D.Zero(), {\n            pointCount, radius, height\n        } = { }) {\n            super(position, {\n                pointCount: pointCount,\n                radius1: radius,\n                radius2: radius,\n                height: height\n            });\n            this.type = \"Prism\";\n        }\n    }\n    class Cloth extends Item {\n        constructor(position = See3D.Math3D.Point3D.Zero(), {\n            w, h, acc = 1\n        } = { }) {\n            super(position, See3D.Math3D.Point3D.Zero());\n            this.type = \"Cloth\";\n            this.points = [ ];\n            this.planes = [ ];\n            this.w = w;\n            this.h = h;\n            this.acc = acc;\n            this.acc = acc;\n            let wC = w / acc, hC = h / acc;\n            for (let i = 0; i < wC; i++) {\n                for (let j = 0; j < hC; j++) {\n                    this.points.push(new Point3D(i * acc - w / 2, 0, j * acc - h / 2));\n                }\n            }\n            for (let i = 0; i < wC - 1; i++) {\n                for (let j = 0; j < hC - 1; j++) {\n                    this.planes.push([ this.getIndex(i, j), this.getIndex(i + 1, j), this.getIndex(i + 1, j + 1), new See3D.Math3D.Point3D(0, 0, 0) ]);\n                    this.planes.push([ this.getIndex(i, j), this.getIndex(i + 1, j + 1), this.getIndex(i, j + 1), new See3D.Math3D.Point3D(0, 0, 0) ]);\n                }\n            }\n            this.maxRadius = Math.sqrt(w ** 2 + h ** 2);\n        }\n        getIndex(x, y) {\n            return x * (this.h / this.acc) + y;\n        }\n        select(x, y, cb) {\n            cb.call(this, this.points[this.getIndex(x, y)]);\n            this.changeMaxRadius();\n            return this;\n        }\n    }\n\n    lib.define(\"Scene\", Scene);\n    lib.define(\"Item\", Item);\n    lib.define(\"BaseCamera\", BaseCamera);\n    lib.define(\"FreeCamera\", FreeCamera);\n    lib.define(\"Point\", Point);\n    lib.define(\"Line\", Line);\n    lib.define(\"Cube\", Cube);\n    lib.define(\"Pyramid\", Pyramid);\n    lib.define(\"Platform\", Platform);\n    lib.define(\"Prism\", Prism);\n    lib.define(\"Cloth\", Cloth);\n\n    lib.toSee3D();\n    lib.global();\n}(See3D);"]}