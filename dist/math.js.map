{"version":3,"sources":["../src/math.js"],"names":["lib","See3D","Library","smallest","smallestLen","probably","n","Number","toFixed","Enum","enums","i","v","LibraryDefineObject","Vector","arr","array","type","push","index","val","sum","Math","sqrt","b","console","error","Error","length","tmp","concat","a","Matrix","res","mod","acos","search","Vector2","Vector3","Vector4","u","norm","x","y","get","set","z","w","h","fill","__w","__h","j","matrix","size","c","k","s","Matrix2x2","det","Parmline2D","v0","v1","p0","p1","v_","Parmline3D","Plane3D","PointPositionWithPlane","point","plane","hs","intersPoints2D","pl1","pl2","p2","d","p0v","p2v","e","f","g","t1","intersPoints3D","define","trans","library","load","DEBUG","loadGlobal","global"],"mappings":"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","file":"math.js","sourcesContent":["'bpo enable';\n\n!function () {\n    let lib = new See3D.Library(\"Math3D\");// 生成一个新的See3D库\n\n\n    /** todo 一些关于精度问题的转化 */\n    // 支持的最小精度\n    const smallest = 1e-5;\n    const smallestLen = 5;\n\n    function probably(n) {\n        return Number(n.toFixed(smallestLen));\n    }\n\n    /** todo 枚举类型 */\n    class Enum extends See3D.LibraryDefineObject {\n        constructor(enums) {\n            super(\"Enum\");\n            let n = 0;\n            for (let i in enums) {\n                let v = enums[i];\n                if (typeof v === \"object\") {\n                    n = v[1];\n                    v = v[0];\n                }\n                this[v] = n;\n                this[\"$\" + n] = v;\n                n++;\n            }\n        }\n        get(n) {\n            return this[\"$\" + n];\n        }\n    }\n\n    /** todo 向量类 */\n    class Vector extends See3D.LibraryDefineObject {\n        constructor(arr) {\n            super(\"Vector\");\n            this.array = [];\n            if (arr.type && arr.type == \"Vector\") for (let i of arr.array) this.array.push(i);\n            else for (let i of arr) this.array.push(i);\n        }\n        set(index, val) {\n            this.array[index] = val;\n            return this;\n        }\n        get(index) {\n            return this.array[index];\n        }\n        mod() {\n            let sum = 0;\n            for (let i of this.array) {\n                sum += i ** 2;\n            }\n            return Math.sqrt(sum);\n        }\n        get length() {\n            return this.array.length;\n        }\n        // 点积\n        operatorMod(b) {\n            if (typeof b === \"number\") {\n                console.error(new Error(\"Error 102: Do not support scalar and vector for dot product operations\"));\n                return null;\n            }\n            if (b.type === \"Vector\") {\n                if (b.length != this.length) {\n                    console.error(new Error(\"Error 100: Vector size does not match\"));\n                    return null;\n                }\n                let sum = 0;\n                for (let i in this.array) {\n                    sum += this.array[i] * b.array[i];\n                }\n                return sum;\n            }\n        }\n        operatorAdd(b) {\n            if (typeof b === \"number\") {\n                let tmp = new Vector([]);\n                tmp.array = tmp.array.concat(this.array);\n                for (let i in this.array) {\n                    tmp.array[i] += b;\n                }\n                return tmp;\n            } else {\n                if (b.type === \"Vector\") {\n                    if (b.length != this.length) {\n                        console.error(new Error(\"Error 100: Vector size does not match\"));\n                        return null;\n                    }\n                    let v = [];\n                    for (let i in this.array) {\n                        v.push(this.array[i] + b.array[i]);\n                    }\n                    return new Vector(v);\n                }\n            }\n        }\n        operatorSub(b) {\n            if (typeof b === \"number\") {\n                let tmp = new Vector([]);\n                tmp.array = tmp.array.concat(this.array);\n                for (let i in this.array) {\n                    tmp.array[i] -= b;\n                }\n                return tmp;\n            } else {\n                if (b.type === \"Vector\") {\n                    if (b.length != this.length) {\n                        console.error(new Error(\"Error 100: Vector size does not match\"));\n                        return null;\n                    }\n                    let v = [];\n                    for (let i in this.array) {\n                        v.push(this.array[i] - b.array[i]);\n                    }\n                    return new Vector(v);\n                }\n            }\n        }\n        operatorDiv(b) {\n            if (typeof b === \"number\") {\n                let tmp = new Vector([]);\n                tmp.array = tmp.array.concat(this.array);\n                for (let i in this.array) {\n                    tmp.array[i] /= b;\n                }\n                return tmp;\n            } else {\n                console.error(new Error(\"Error 102: Do not support scalar and vector for dot div operations\"));\n                return null;\n            }\n        }\n        operatorMul(b) {\n            if (typeof b === \"number\") {\n                let tmp = new Vector([]);\n                tmp.array = tmp.array.concat(this.array);\n                for (let i in this.array) {\n                    tmp.array[i] *= b;\n                }\n                return tmp;\n            } else {\n                // 叉乘\n                // console.error(new Error(\"Error 102: Do not support scalar and vector for dot div operations\"));\n                let a = new Matrix(this.length, 1, [this.array]);\n                let arr = [];\n                for (let i = 0; i < b.length; i++) {\n                    arr.push([b.array[i]]);\n                }\n                b = new Matrix(1, b.length, arr);\n                // console.log(a);\n                // console.log(b);\n                return a * b;\n            }\n        }\n        operatorBinaryXor(b) {\n            if (typeof b === \"number\") {\n                console.error(new Error(\"Error 102: Do not support scalar and vector for dot product operations\"));\n                return null;\n            }\n            if (b.type === \"Vector\") {\n                let res = this % b;\n                res /= this.mod();\n                res /= b.mod();\n                res = Math.acos(res);\n                return probably(res);\n            }\n        }\n        trans(type) {\n            if (type.search(/vector/i)) {\n                if (this.length == 2) return new Vector2(...this.array);\n                if (this.length == 3) return new Vector3(...this.array);\n                if (this.length == 4) return new Vector4(...this.array);\n                return new Vector(this.array);\n            }\n        }\n        norm() {\n            return this / this.mod();\n        }\n        proj(u) {// 投影\n            let v = this.norm();\n            let n = v * (u % v);\n            return n / (v.mod() * v.mod());\n        }\n        operatorEqual(b) {\n            if (b.length != this.length) {\n                console.error(new Error(\"Error 100: Vector size does not match\"));\n                return null;\n            }\n            for (let i = 0; i < this.length; i++) {\n                if (b.array[i] != this.array[i]) return false;\n            }\n            return true;\n        }\n    }\n    class Vector2 extends Vector {\n        constructor(x = 0, y = 0) {\n            if (x.type && x.type == \"Vector\") super(x);\n            else super([x, y]);\n        }\n        get x() {\n            return this.get(0);\n        }\n        set x(n) {\n            this.set(0, n);\n            return n;\n        }\n        get y() {\n            return this.get(1);\n        }\n        set y(n) {\n            this.set(1, n);\n            return n;\n        }\n        static Zero() {\n            return new Vector2();\n        }\n    }\n    class Vector3 extends Vector {\n        constructor(x = 0, y = 0, z = 0) {\n            if (x.type && x.type == \"Vector\") super(x);\n            else super([x, y, z]);\n        }\n        get x() {\n            return this.get(0);\n        }\n        set x(n) {\n            this.set(0, n);\n            return n;\n        }\n        get y() {\n            return this.get(1);\n        }\n        set y(n) {\n            this.set(1, n);\n            return n;\n        }\n        get z() {\n            return this.get(2);\n        }\n        set z(n) {\n            this.set(2, n);\n            return n;\n        }\n        static Zero() {\n            return new Vector3();\n        }\n        // operatorMul(b) {\n        //     console.log(b);\n        //     if (typeof b === \"number\") {\n        //         let tmp = new Vector([]);\n        //         tmp.array = tmp.array.concat(this.array);\n        //         for (let i in this.array) {\n        //             tmp.array[i] *= b;\n        //         }\n        //         return tmp;\n        //     } else {\n        //         // 叉乘\n        //         // let m = new Matrix(3, 3, [\n        //         //     [new Vector3(1, 0, 0), new Vector3(0, 1, 0), new Vector3(0, 0, 1)]\n        //         // ]);\n        //         let a = new Matrix(this.length, 1, [this.array]);\n        //         console.log(a);\n        //         return null;\n        //     }\n        // }\n    }\n    class Vector4 extends Vector {\n        constructor(x = 0, y = 0, z = 0, w = 1) {\n            if (x.type && x.type == \"Vector\") super(x);\n            else super([x, y, z, w]);\n        }\n        get x() {\n            return this.get(0) / this.w;\n        }\n        set x(n) {\n            this.set(0, n);\n            return n;\n        }\n        get y() {\n            return this.get(1) / this.w;\n        }\n        set y(n) {\n            this.set(1, n);\n            return n;\n        }\n        get z() {\n            return this.get(2) / this.w;\n        }\n        set z(n) {\n            this.set(2, n);\n            return n;\n        }\n        get w() {\n            return this.get(3);\n        }\n        set w(n) {\n            this.set(3, n);\n            return n;\n        }\n        static Zero() {\n            return new Vector4();\n        }\n    }\n\n    /** todo 矩阵类 */\n    class Matrix extends See3D.LibraryDefineObject {\n        constructor(w, h, fill = 0) {\n            super(\"Matrix\");\n            this.array = [];\n            if (w.type && w.type == \"Matrix\") {// 复制构造函数\n                this.__w = w.w;\n                this.__h = w.h;\n                for (let i = 0; i < this.__h; i++) {\n                    this.array.push([]);\n                    for (let j = 0; j < this.__w; j++) {\n                        this.array[i].push(w.array[i][j]);\n                    }\n                }\n            } else {\n                this.__w = w;\n                this.__h = h;\n                for (let i = 0 ;i < h; i++) {\n                    this.array.push([]);\n                    for (let j = 0; j < w; j++) {\n                        if (typeof fill === \"number\")\n                            this.array[i].push(fill);\n                        else\n                            this.array[i].push(fill[i][j]);\n                    }\n                }\n            }\n        }\n        get w() {\n            return this.__w;\n        }\n        get h() {\n            return this.__h;\n        }\n        T() {\n            let matrix = new Matrix(this.__h, this.__w);\n            for (let i = 0 ;i < this.__w; i++) {\n                for (let j = 0; j < this.__h; j++) {\n                    matrix.array[i][j] = this.array[j][i];\n                }\n            }\n            return matrix;\n        }\n        size() {\n            return new Vector2(this.__w, this.__h);\n        }\n        get(i, j) {\n            return this.array[i][j];\n        }\n        set(i, j, v) {\n            this.array[i][j] = v;\n            return this;\n        }\n        operatorAdd(b) {\n            // console.log(this.size() == b.size());\n            if (this.size() != b.size()) {\n                console.error(new Error(\"Error 100: Matrix size does not match\"));\n                return null;\n            }\n            let c = new Matrix(this.w, this.h, this.array);\n            for (let i = 0; i < this.h; i++) {\n                for (let j = 0; j < this.w; j++) {\n                    c.array[i][j] += b.array[i][j];\n                }\n            }\n            return c;\n        }\n        operatorSub(b) {\n            // console.log(this.size() == b.size());\n            if (this.size() != b.size()) {\n                console.error(new Error(\"Error 100: Matrix size does not match\"));\n                return null;\n            }\n            let c = new Matrix(this.w, this.h, this.array);\n            for (let i = 0; i < this.h; i++) {\n                for (let j = 0; j < this.w; j++) {\n                    c.array[i][j] -= b.array[i][j];\n                }\n            }\n            return c;\n        }\n        operatorMul(b) {\n            // console.log(this.size() == b.size());\n            if (typeof b == \"object\") {\n                if (this.w != b.h) {\n                    console.error(new Error(\"Error 100: Matrix size does not match\"));\n                    return null;\n                }\n                let n = this.w;\n                let c = new Matrix(this.h, b.w, 0);\n                for (let i = 0; i < this.h; i++) {\n                    for (let j = 0; j < b.w; j++) {\n                        let sum = 0;\n                        for (let k = 0; k < n; k++) {\n                            sum += this.array[i][k] * b.array[k][j];\n                        }\n                        c.array[i][j] = sum;\n                    }\n                }\n                return c;\n            } else {\n                let c = new Matrix(this.w, this.h, [].concat(this.array));\n                for (let i = 0; i < this.h; i++) {\n                    for (let j = 0; j < this.w; j++) {\n                        c.array[i][j] *= b;\n                    }\n                }\n                return c;\n            }\n        }\n        static identity(s) {\n            let matrix = new Matrix(s, s);\n            for (let i = 0; i < s; i++) {\n                matrix.array[i][i] = 1;\n            }\n            return matrix;\n        }\n        static Zero(w, h) {\n            return new Matrix(w, h);\n        }\n    }\n    class Matrix2x2 extends Matrix {\n        constructor(fill) {\n            super(2, 2, fill);\n        }\n        inverse() {\n            let tmp = 1 / this.det();\n            let c = new Matrix2x2([[this.array[1][1], -this.array[0][1]], [-this.array[1][0], this.array[0][0]]]);\n            c = c * tmp;\n            return c;\n        }\n        det() {\n            return this.array[0][0] * this.array[1][1] + this.array[0][1] * this.array[1][0];\n        }\n    }\n\n    /** todo 直线类 */\n    // 表示方法: 参数化直线\n    // 即: 起点, 终点, 方向\n    // p(x, y, z) = p0 + v_ * t\n    // t ∈ [-∞, +∞]\n    class Parmline2D extends See3D.LibraryDefineObject {\n        constructor(v0, v1) {\n            super(\"Parmline\");\n            this.p0 = new Vector2(v0);\n            this.p1 = new Vector2(v1);\n            this.v = new Vector2(v1 - v0);\n            this.v_ = this.v.norm();\n        }\n    }\n    class Parmline3D extends See3D.LibraryDefineObject {\n        constructor(v0, v1) {\n            super(\"Parmline\");\n            this.p0 = new Vector3(v0);\n            this.p1 = new Vector3(v1);\n            this.v = new Vector3(v1 - v0);\n            this.v_ = this.v.norm();\n        }\n    }\n\n    /** todo 平面类 */\n    // 表示方法: 点-法线形式\n    // a * (x - x0) + b * (y - y0) + c * (z - z0) = 0\n    // 或\n    // a * x + b * y + c * z + (-a * x0 - b * y0 - c * z0) = 0\n    class Plane3D extends See3D.LibraryDefineObject {\n        constructor(n, p0) {\n            super(\"Plane\");\n            this.n = new Vector3(n);// 法线向量\n            this.p0 = new Vector3(p0);// 平面上一点\n        }\n    }\n\n\n    /** todo 平面分割3D空间, 判断点位于哪个半空间中, -1为负半空间, 0为平面上, 1为正半空间 */\n    function PointPositionWithPlane(point, plane) {\n        let a = plane.n.x, b = plane.n.y, c = plane.n.z;\n        let hs = a * (point.x - plane.p0.x) + b * (point.y - plane.p0.y) + c * (point.z - plane.p0.z);\n        if (hs > 0) return 1;\n        if (hs < 0) return -1;\n        return 0;\n    }\n\n\n    /** todo 计算两参数化2D线段的交点 */\n    function intersPoints2D(pl1, pl2) {\n        let p0 = pl1.p0;\n        let p2 = pl2.p0;\n        let a = p0.x, b = p0.y, c = p2.x, d = p2.y;\n        let p0v = pl1.v;\n        let p2v = pl2.v;\n        let e = p0v.x, f = p0v.y, g = p2v.x, h = p2v.y;\n        // console.log(a, b, c, d, e, f, g, h);\n        let t1 =\n            (h * (c - a) - g * (d - b))\n            /\n            (h * e - g * f)\n        ;\n        // let t2 =\n        //     (-c + a + e * t1)\n        //     /\n        //     g\n        // ;\n        let x = a + e * t1;\n        let y = b + f * t1;\n        return new Vector2(x, y);\n    }\n    /** todo 计算两参数化3D线段的交点 */\n    function intersPoints3D(pl1, pl2) {\n        let p0 = pl1.p0;\n        let p2 = pl2.p0;\n        let a = p0.x, b = p0.y, c = p2.x, d = p2.y;\n        let p0v = pl1.v;\n        let p2v = pl2.v;\n        let e = p0v.x, f = p0v.y, g = p2v.x, h = p2v.y;\n        // console.log(a, b, c, d, e, f, g, h);\n        let t1 =\n            (h * (c - a) - g * (d - b))\n            /\n            (h * e - g * f)\n        ;\n        // let t2 =\n        //     (-c + a + e * t1)\n        //     /\n        //     g\n        // ;\n        let x = a + e * t1;\n        let y = b + f * t1;\n        let z = p0.z + p0v.z * t1;\n        return new Vector3(x, y, z);\n    }\n\n    // 在库中定义所有的接口\n    lib.define(\"smallest\", smallest);\n    lib.define(\"smallestLen\", smallestLen);\n    lib.define(\"probably\", probably);\n\n    lib.define(\"Enum\", Enum);\n\n    lib.define(\"Vector\", Vector);\n    lib.define(\"Vector2\", Vector2);\n    lib.define(\"Vector3\", Vector3);\n    lib.define(\"Vector4\", Vector4);\n\n    lib.define(\"Matrix\", Matrix);\n    lib.define(\"Matrix2x2\", Matrix2x2);\n\n    lib.define(\"Parmline2D\", Parmline2D);\n    lib.define(\"Parmline3D\", Parmline3D);\n    lib.define(\"Plane3D\", Plane3D);\n    lib.define(\"PointPositionWithPlane\", PointPositionWithPlane);\n    lib.define(\"intersPoints2D\", intersPoints2D);\n    lib.define(\"intersPoints3D\", intersPoints3D);\n\n    lib.trans();// 在库的全局添加接口\n    See3D.library(lib);// 将库加载入See3D中\n    See3D.load(\"Math3D\");// 将库加入See3D的默认加载队列\n    if (See3D.DEBUG) See3D.loadGlobal(\"Math3D\");\n    if (See3D.DEBUG) lib.global();\n    See3D.lib(\"Math3D\");\n}();"]}