{"version":3,"sources":["../src/math.js"],"names":["lib","See3D","Library","smallest","probably","n","v","Number","toFixed","Enum","enums","i","LibraryDefineObject","Vector","arr","array","push","index","val","sum","Math","sqrt","b","console","error","Error","type","length","tmp","concat","a","Matrix","res","mod","acos","search","Vector2","Vector3","Vector4","u","norm","x","y","get","set","z","w","h","fill","__w","__h","j","matrix","size","c","k","s","Matrix2x2","det","StraightLine2D","x0","y0","x1","y1","p0","p1","StraightLine3D","z0","z1","define","trans","library","load","DEBUG","loadGlobal","global"],"mappings":"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","file":"math.js","sourcesContent":["'bpo enable';\n\n!function () {\n    let lib = new See3D.Library(\"Math3D\");// 生成一个新的See3D库\n\n    // 支持的最小精度\n    const smallest = 1e-5;\n    \n    function probably(n) {\n        let v = Number(n.toFixed(5));\n        if (v + smallest >= n) return v;\n        return n;\n    }\n\n    // 枚举类型\n    class Enum extends See3D.LibraryDefineObject {\n        constructor(enums) {\n            super(\"Enum\");\n            let n = 0;\n            for (let i in enums) {\n                let v = enums[i];\n                if (typeof v === \"object\") {\n                    n = v[1];\n                    v = v[0];\n                }\n                this[v] = n;\n                this[\"$\" + n] = v;\n                n++;\n            }\n        }\n        get(n) {\n            return this[\"$\" + n];\n        }\n    }\n\n    // 向量类\n    class Vector extends See3D.LibraryDefineObject {\n        constructor(arr) {\n            super(\"Vector\");\n            this.array = [];\n            for (let i of arr) this.array.push(i);\n        }\n        set(index, val) {\n            this.array[index] = val;\n            return this;\n        }\n        get(index) {\n            return this.array[index];\n        }\n        mod() {\n            let sum = 0;\n            for (let i of this.array) {\n                sum += i ** 2;\n            }\n            return Math.sqrt(sum);\n        }\n        get length() {\n            return this.array.length;\n        }\n        // 点积\n        operatorMod(b) {\n            if (typeof b === \"number\") {\n                console.error(new Error(\"Error 102: Do not support scalar and vector for dot product operations\"));\n                return null;\n            }\n            if (b.type === \"Vector\") {\n                if (b.length != this.length) {\n                    console.error(new Error(\"Error 100: Vector size does not match\"));\n                    return null;\n                }\n                let sum = 0;\n                for (let i in this.array) {\n                    sum += this.array[i] * b.array[i];\n                }\n                return sum;\n            }\n        }\n        operatorAdd(b) {\n            if (typeof b === \"number\") {\n                let tmp = new Vector([]);\n                tmp.array = tmp.array.concat(this.array);\n                for (let i in this.array) {\n                    tmp.array[i] += b;\n                }\n                return tmp;\n            } else {\n                if (b.type === \"Vector\") {\n                    if (b.length != this.length) {\n                        console.error(new Error(\"Error 100: Vector size does not match\"));\n                        return null;\n                    }\n                    let v = [];\n                    for (let i in this.array) {\n                        v.push(this.array[i] + b.array[i]);\n                    }\n                    return new Vector(v);\n                }\n            }\n        }\n        operatorSub(b) {\n            if (typeof b === \"number\") {\n                let tmp = new Vector([]);\n                tmp.array = tmp.array.concat(this.array);\n                for (let i in this.array) {\n                    tmp.array[i] -= b;\n                }\n                return tmp;\n            } else {\n                if (b.type === \"Vector\") {\n                    if (b.length != this.length) {\n                        console.error(new Error(\"Error 100: Vector size does not match\"));\n                        return null;\n                    }\n                    let v = [];\n                    for (let i in this.array) {\n                        v.push(this.array[i] - b.array[i]);\n                    }\n                    return new Vector(v);\n                }\n            }\n        }\n        operatorDiv(b) {\n            if (typeof b === \"number\") {\n                let tmp = new Vector([]);\n                tmp.array = tmp.array.concat(this.array);\n                for (let i in this.array) {\n                    tmp.array[i] /= b;\n                }\n                return tmp;\n            } else {\n                console.error(new Error(\"Error 102: Do not support scalar and vector for dot div operations\"));\n                return null;\n            }\n        }\n        operatorMul(b) {\n            if (typeof b === \"number\") {\n                let tmp = new Vector([]);\n                tmp.array = tmp.array.concat(this.array);\n                for (let i in this.array) {\n                    tmp.array[i] *= b;\n                }\n                return tmp;\n            } else {\n                // 叉乘\n                // console.error(new Error(\"Error 102: Do not support scalar and vector for dot div operations\"));\n                let a = new Matrix(this.length, 1, [this.array]);\n                let arr = [];\n                for (let i = 0; i < b.length; i++) {\n                    arr.push([b.array[i]]);\n                }\n                b = new Matrix(1, b.length, arr);\n                // console.log(a);\n                // console.log(b);\n                return a * b;\n            }\n        }\n        operatorBinaryXor(b) {\n            if (typeof b === \"number\") {\n                console.error(new Error(\"Error 102: Do not support scalar and vector for dot product operations\"));\n                return null;\n            }\n            if (b.type === \"Vector\") {\n                let res = this % b;\n                res /= this.mod();\n                res /= b.mod();\n                res = Math.acos(res);\n                return probably(res);\n            }\n        }\n        trans(type) {\n            if (type.search(/vector/i)) {\n                if (this.length == 2) return new Vector2(...this.array);\n                if (this.length == 3) return new Vector3(...this.array);\n                if (this.length == 4) return new Vector4(...this.array);\n                return new Vector(this.array);\n            }\n        }\n        norm() {\n            return this / this.mod();\n        }\n        proj(u) {// 投影\n            let v = this.norm();\n            let n = v * (u % v);\n            return n / (v.mod() * v.mod());\n        }\n        operatorEqual(b) {\n            if (b.length != this.length) {\n                console.error(new Error(\"Error 100: Vector size does not match\"));\n                return null;\n            }\n            for (let i = 0; i < this.length; i++) {\n                if (b.array[i] != this.array[i]) return false;\n            }\n            return true;\n        }\n    }\n    class Vector2 extends Vector {\n        constructor(x = 0, y = 0) {\n            super([x, y]);\n        }\n        get x() {\n            return this.get(0);\n        }\n        set x(n) {\n            this.set(0, n);\n            return n;\n        }\n        get y() {\n            return this.get(1);\n        }\n        set y(n) {\n            this.set(1, n);\n            return n;\n        }\n        static Zero() {\n            return new Vector2();\n        }\n    }\n    class Vector3 extends Vector {\n        constructor(x = 0, y = 0, z = 0) {\n            super([x, y, z]);\n        }\n        get x() {\n            return this.get(0);\n        }\n        set x(n) {\n            this.set(0, n);\n            return n;\n        }\n        get y() {\n            return this.get(1);\n        }\n        set y(n) {\n            this.set(1, n);\n            return n;\n        }\n        get z() {\n            return this.get(2);\n        }\n        set z(n) {\n            this.set(2, n);\n            return n;\n        }\n        static Zero() {\n            return new Vector3();\n        }\n        // operatorMul(b) {\n        //     console.log(b);\n        //     if (typeof b === \"number\") {\n        //         let tmp = new Vector([]);\n        //         tmp.array = tmp.array.concat(this.array);\n        //         for (let i in this.array) {\n        //             tmp.array[i] *= b;\n        //         }\n        //         return tmp;\n        //     } else {\n        //         // 叉乘\n        //         // let m = new Matrix(3, 3, [\n        //         //     [new Vector3(1, 0, 0), new Vector3(0, 1, 0), new Vector3(0, 0, 1)]\n        //         // ]);\n        //         let a = new Matrix(this.length, 1, [this.array]);\n        //         console.log(a);\n        //         return null;\n        //     }\n        // }\n    }\n    class Vector4 extends Vector {\n        constructor(x = 0, y = 0, z = 0, w = 1) {\n            super([x, y, z, w]);\n        }\n        get x() {\n            return this.get(0) / this.w;\n        }\n        set x(n) {\n            this.set(0, n);\n            return n;\n        }\n        get y() {\n            return this.get(1) / this.w;\n        }\n        set y(n) {\n            this.set(1, n);\n            return n;\n        }\n        get z() {\n            return this.get(2) / this.w;\n        }\n        set z(n) {\n            this.set(2, n);\n            return n;\n        }\n        get w() {\n            return this.get(3);\n        }\n        set w(n) {\n            this.set(3, n);\n            return n;\n        }\n        static Zero() {\n            return new Vector4();\n        }\n    }\n\n    // 矩阵类\n    class Matrix extends See3D.LibraryDefineObject {\n        constructor(w, h, fill = 0) {\n            super(\"Matrix\");\n            this.array = [];\n            this.__w = w;\n            this.__h = h;\n            for (let i = 0 ;i < h; i++) {\n                this.array.push([]);\n                for (let j = 0; j < w; j++) {\n                    if (typeof fill === \"number\")\n                        this.array[i].push(fill);\n                    else\n                        this.array[i].push(fill[i][j]);\n                }\n            }\n        }\n        get w() {\n            return this.__w;\n        }\n        get h() {\n            return this.__h;\n        }\n        T() {\n            let matrix = new Matrix(this.__h, this.__w);\n            for (let i = 0 ;i < this.__w; i++) {\n                for (let j = 0; j < this.__h; j++) {\n                    matrix.array[i][j] = this.array[j][i];\n                }\n            }\n            return matrix;\n        }\n        size() {\n            return new Vector2(this.__w, this.__h);\n        }\n        get(i, j) {\n            return this.array[i][j];\n        }\n        set(i, j, v) {\n            this.array[i][j] = v;\n            return this;\n        }\n        operatorAdd(b) {\n            // console.log(this.size() == b.size());\n            if (this.size() != b.size()) {\n                console.error(new Error(\"Error 100: Matrix size does not match\"));\n                return null;\n            }\n            let c = new Matrix(this.w, this.h, this.array);\n            for (let i = 0; i < this.h; i++) {\n                for (let j = 0; j < this.w; j++) {\n                    c.array[i][j] += b.array[i][j];\n                }\n            }\n            return c;\n        }\n        operatorSub(b) {\n            // console.log(this.size() == b.size());\n            if (this.size() != b.size()) {\n                console.error(new Error(\"Error 100: Matrix size does not match\"));\n                return null;\n            }\n            let c = new Matrix(this.w, this.h, this.array);\n            for (let i = 0; i < this.h; i++) {\n                for (let j = 0; j < this.w; j++) {\n                    c.array[i][j] -= b.array[i][j];\n                }\n            }\n            return c;\n        }\n        operatorMul(b) {\n            // console.log(this.size() == b.size());\n            if (typeof b == \"object\") {\n                if (this.w != b.h) {\n                    console.error(new Error(\"Error 100: Matrix size does not match\"));\n                    return null;\n                }\n                let n = this.w;\n                let c = new Matrix(this.h, b.w, 0);\n                for (let i = 0; i < this.h; i++) {\n                    for (let j = 0; j < b.w; j++) {\n                        let sum = 0;\n                        for (let k = 0; k < n; k++) {\n                            sum += this.array[i][k] * b.array[k][j];\n                        }\n                        c.array[i][j] = sum;\n                    }\n                }\n                return c;\n            } else {\n                let c = new Matrix(this.w, this.h, [].concat(this.array));\n                for (let i = 0; i < this.h; i++) {\n                    for (let j = 0; j < this.w; j++) {\n                        c.array[i][j] *= b;\n                    }\n                }\n                return c;\n            }\n        }\n        static identity(s) {\n            let matrix = new Matrix(s, s);\n            for (let i = 0; i < s; i++) {\n                matrix.array[i][i] = 1;\n            }\n            return matrix;\n        }\n        static Zero(w, h) {\n            return new Matrix(w, h);\n        }\n    }\n    class Matrix2x2 extends Matrix {\n        constructor(fill) {\n            super(2, 2, fill);\n        }\n        inverse() {\n            let tmp = 1 / this.det();\n            let c = new Matrix2x2([[this.array[1][1], -this.array[0][1]], [-this.array[1][0], this.array[0][0]]]);\n            c = c * tmp;\n            return c;\n        }\n        det() {\n            return this.array[0][0] * this.array[1][1] + this.array[0][1] * this.array[1][0];\n        }\n    }\n\n    // 直线类\n    class StraightLine2D extends See3D.LibraryDefineObject {\n        constructor(x0, y0, x1, y1) {\n            super(\"StraightLine\");\n            this.p0 = new Vector2(x0, y0);\n            this.p1 = new Vector2(x1, y1);\n            this.v = new Vector2(x1 - x0, y1 - y0);\n        }\n    }\n    class StraightLine3D extends See3D.LibraryDefineObject {\n        constructor(x0, y0, z0, x1, y1, z1) {\n            super(\"StraightLine\");\n            this.p0 = new Vector3(x0, y0, z0);\n            this.p1 = new Vector3(x1, y1, z1);\n            this.v = new Vector3(x1 - x0, y1 - y0, z1 - z0);\n        }\n    }\n\n    // 在库中定义所有的接口\n    lib.define(\"smallest\", smallest);\n    lib.define(\"probably\", probably);\n\n    lib.define(\"Enum\", Enum);\n\n    lib.define(\"Vector\", Vector);\n    lib.define(\"Vector2\", Vector2);\n    lib.define(\"Vector3\", Vector3);\n    lib.define(\"Vector4\", Vector4);\n\n    lib.define(\"Matrix\", Matrix);\n    lib.define(\"Matrix2x2\", Matrix2x2);\n\n    lib.define(\"StraightLine2D\", StraightLine2D);\n    lib.define(\"StraightLine3D\", StraightLine3D);\n\n    lib.trans();// 在库的全局添加接口\n    See3D.library(lib);// 将库加载入See3D中\n    See3D.load(\"Math3D\");// 将库加入See3D的默认加载队列\n    if (See3D.DEBUG) See3D.loadGlobal(\"Math3D\");\n    if (See3D.DEBUG) lib.global();\n    See3D.lib(\"Math3D\");\n}();"]}