{"version":3,"sources":["../src/math.js"],"names":["String","prototype","last","length","lib","See3D","Library","smallest","smallestLen","probably","n","Number","toFixed","Enum","enums","i","v","LibraryDefineObject","MathSet","token","expr","arguments","str","trim","console","error","Error","substring","splitIndex","search","replace","RegExp","Boolean","eval","Interval","type","s","e","st","et","firstOp","lastOp","numbers","split","Vector","arr","array","push","index","val","sum","Math","sqrt","b","tmp","concat","a","Matrix","res","mod","acos","Vector2","Vector3","Vector4","u","norm","x","y","get","set","z","w","h","fill","__w","__h","j","matrix","size","c","k","Matrix2x2","det","Parmline2D","v0","v1","p0","p1","v_","Parmline3D","Plane3D","PointPositionWithPlane","point","plane","hs","intersParmlines2D","pl1","pl2","p2","d","p0v","p2v","f","g","t1","intersParmlines3D","tInterval","intersParmlinePlane","parmline","x0","y0","z0","vx","vy","vz","t","intersSegmentPlane","have","Quaternion","q0","q1","q2","q3","q","qv","p","r","conjugate","mod2","define","trans","library","load","DEBUG","loadGlobal","global"],"mappings":"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","file":"math.js","sourcesContent":["'bpo enable';\n\n/** todo 为String类型添加方法 */\n!function () {\n    String.prototype.last = function () {\n        return this[this.length - 1];\n    };\n}();\n\n/** todo 新建一个Math3D库 */\n!function () {\n    let lib = new See3D.Library(\"Math3D\");// 生成一个新的See3D库\n\n    /** todo 一些关于精度问题的转化 */\n    // 支持的最小精度\n    const smallest = 1e-5;\n    const smallestLen = 5;\n\n    function probably(n) {\n        return Number(n.toFixed(smallestLen));\n    }\n\n    /** todo 枚举类型 */\n    class Enum extends See3D.LibraryDefineObject {\n        /*\n        * 使用方法:\n        * let colors = new Enum([\"RED\", \"WHITE\", \"BLACK\"])\n        */\n        constructor(enums) {\n            super(\"Enum\");\n            let n = 0;\n            for (let i in enums) {\n                let v = enums[i];\n                if (typeof v === \"object\") {\n                    n = v[1];\n                    v = v[0];\n                }\n                this[v] = n;\n                this[\"$\" + n] = v;\n                n++;\n            }\n        }\n\n        get(n) {\n            return this[\"$\" + n];\n        }\n    }\n\n    /** todo 提供数学意义上的集合类 */\n    // {(token) | expr}\n    class MathSet extends See3D.LibraryDefineObject {\n        constructor(token, expr) {\n            super(\"MathSet\");\n            if (arguments.length == 1) {// 只有一个参数\n                let str = token;\n                str = str.trim();\n                if (\n                    str.length <= 2 ||\n                    str[0] != \"{\" || str.last() != \"}\" // 不以'{'开头或不以'}'结尾\n                ) {\n                    console.error(new Error(\"Error 104: Illegal set string '\" + str + \"'\"));\n                    return;\n                }\n                str = str.substring(1, str.length - 1);\n                token = \"\";\n\n                let splitIndex = str.search(/\\|/);\n                if (splitIndex < 0) {\n                    console.error(new Error(\"Error 104: Illegal set string '\" + str + \"'\"));\n                    return;\n                }\n\n                // 获取token\n                for (let i = 0; i < splitIndex; i++) {\n                    token += str[i];\n                }\n                token = token.trim();\n\n                expr = \"\";\n                // 获取expr\n                for (let i = splitIndex + 1; i < str.length; i++) {\n                    expr += str[i];\n                }\n            }\n            this.token = token;\n            this.expr = expr;\n        }\n        have(n) {\n            let expr = this.expr.replace(new RegExp(\"([^a-zA-Z_])\" + this.token + \"([^a-zA-Z_])\", \"g\"), \"$1\" + n + \"$2\");\n            return Boolean(eval(expr));\n        }\n    }\n\n    /** todo 提供区间类 */\n    class Interval extends MathSet {\n        constructor(type, s, e) {\n            // super(\"Interval\");\n            let st, et;// 存储是开还是闭\n            const token = \"n\";// 变量名, {x | a < x < b}\n            let expr = \"\";\n            let firstOp, lastOp;\n            if (arguments.length == 1) {// 只有一个参数\n                let str = type;\n                str = str.trim();\n                st = str[0];\n                et = str.last();\n\n                // 检查类型\n                if (st != \"[\" && st != \"(\") {\n                    console.error(new Error(\"Error 103: Illegal interval identifier '\" + st + \"'\"));\n                    return;\n                }\n                if (et != \"]\" && et != \")\") {\n                    console.error(new Error(\"Error 103: Illegal interval identifier '\" + et + \"'\"));\n                    return;\n                }\n                str = str.substring(1, str.length - 1);\n                let numbers = str.split(\",\");\n                if (numbers.length < 2) str.split(/\\s+/g);\n                if (st == \"[\") firstOp = \"<=\";\n                if (st == \"(\") firstOp = \"<\";\n                if (et == \"]\") lastOp = \"<=\";\n                if (et == \")\") lastOp = \"<\";\n                s = numbers[0];\n                e = numbers[1];\n                expr = s + firstOp + token + \" && \" + token + lastOp + e;\n                // this.st = st;\n                // this.et = et;\n                // this.s = numbers[0];// 区间的第一个数\n                // this.e = numbers[1];// 区间的第二个数\n            } else {\n                st = type[0];\n                et = type[1];\n                // 检查类型\n                if (st != \"[\" && st != \"(\") {\n                    console.error(new Error(\"Error 103: Illegal interval identifier '\" + st + \"'\"));\n                    return;\n                }\n                if (et != \"]\" && et != \")\") {\n                    console.error(new Error(\"Error 103: Illegal interval identifier '\" + et + \"'\"));\n                    return;\n                }\n                if (st == \"[\") firstOp = \"<=\";\n                if (st == \"(\") firstOp = \"<\";\n                if (et == \"]\") lastOp = \"<=\";\n                if (et == \")\") lastOp = \"<\";\n                // console.log(firstOp, lastOp, s, e);\n                expr = String(s) + firstOp + token + \" && \" + token + lastOp + String(e);\n            }\n            super(token, expr);\n        }\n    }\n\n    /** todo 向量类 */\n    // WARNING: %代表点积, *代表叉乘\n    class Vector extends See3D.LibraryDefineObject {\n        constructor(arr) {\n            super(\"Vector\");\n            this.array = [];\n            if (arr.type && arr.type == \"Vector\") for (let i of arr.array) this.array.push(i);\n            else for (let i of arr) this.array.push(i);\n        }\n        set(index, val) {\n            this.array[index] = val;\n            return this;\n        }\n        get(index) {\n            return this.array[index];\n        }\n        mod() {\n            let sum = 0;\n            for (let i of this.array) {\n                sum += i ** 2;\n            }\n            return Math.sqrt(sum);\n        }\n        get length() {\n            return this.array.length;\n        }\n        // 点积\n        operatorMod(b) {\n            if (typeof b === \"number\") {\n                console.error(new Error(\"Error 102: Do not support scalar and vector for dot product operations\"));\n                return null;\n            }\n            if (b.type === \"Vector\") {\n                if (b.length != this.length) {\n                    console.error(new Error(\"Error 100: Vector size does not match\"));\n                    return null;\n                }\n                let sum = 0;\n                for (let i in this.array) {\n                    sum += this.array[i] * b.array[i];\n                }\n                return sum;\n            }\n        }\n        operatorAdd(b) {\n            if (typeof b === \"number\") {\n                let tmp = new Vector([]);\n                tmp.array = tmp.array.concat(this.array);\n                for (let i in this.array) {\n                    tmp.array[i] += b;\n                }\n                return tmp;\n            } else {\n                if (b.type === \"Vector\") {\n                    if (b.length != this.length) {\n                        console.error(new Error(\"Error 100: Vector size does not match\"));\n                        return null;\n                    }\n                    let v = [];\n                    for (let i in this.array) {\n                        v.push(this.array[i] + b.array[i]);\n                    }\n                    return new Vector(v);\n                }\n            }\n        }\n        operatorSub(b) {\n            if (typeof b === \"number\") {\n                let tmp = new Vector([]);\n                tmp.array = tmp.array.concat(this.array);\n                for (let i in this.array) {\n                    tmp.array[i] -= b;\n                }\n                return tmp;\n            } else {\n                if (b.type === \"Vector\") {\n                    if (b.length != this.length) {\n                        console.error(new Error(\"Error 100: Vector size does not match\"));\n                        return null;\n                    }\n                    let v = [];\n                    for (let i in this.array) {\n                        v.push(this.array[i] - b.array[i]);\n                    }\n                    return new Vector(v);\n                }\n            }\n        }\n        operatorDiv(b) {\n            if (typeof b === \"number\") {\n                let tmp = new Vector([]);\n                tmp.array = tmp.array.concat(this.array);\n                for (let i in this.array) {\n                    tmp.array[i] /= b;\n                }\n                return tmp;\n            } else {\n                console.error(new Error(\"Error 102: Do not support scalar and vector for dot div operations\"));\n                return null;\n            }\n        }\n        operatorMul(b) {\n            if (typeof b === \"number\") {\n                let tmp = new Vector([]);\n                tmp.array = tmp.array.concat(this.array);\n                for (let i in this.array) {\n                    tmp.array[i] *= b;\n                }\n                return tmp;\n            } else {\n                // 叉乘\n                let a = new Matrix(this.length, 1, [this.array]);\n                let arr = [];\n                for (let i = 0; i < b.length; i++) {\n                    arr.push([b.array[i]]);\n                }\n                b = new Matrix(1, b.length, arr);\n                // console.log(a);\n                // console.log(b);\n                return a * b;\n            }\n        }\n        operatorBinaryXor(b) {\n            if (typeof b === \"number\") {\n                console.error(new Error(\"Error 102: Do not support scalar and vector for dot product operations\"));\n                return null;\n            }\n            if (b.type === \"Vector\") {\n                let res = this % b;\n                res /= this.mod();\n                res /= b.mod();\n                res = Math.acos(res);\n                return probably(res);\n            }\n        }\n        trans(type) {\n            if (type.search(/vector/i)) {\n                if (this.length == 2) return new Vector2(...this.array);\n                if (this.length == 3) return new Vector3(...this.array);\n                if (this.length == 4) return new Vector4(...this.array);\n                return new Vector(this.array);\n            }\n        }\n        norm() {\n            return this / this.mod();\n        }\n        proj(u) {// 投影\n            let v = this.norm();\n            let n = v * (u % v);\n            return n / (v.mod() * v.mod());\n        }\n        operatorEqual(b) {\n            if (b.length != this.length) {\n                console.error(new Error(\"Error 100: Vector size does not match\"));\n                return null;\n            }\n            for (let i = 0; i < this.length; i++) {\n                if (b.array[i] != this.array[i]) return false;\n            }\n            return true;\n        }\n    }\n    class Vector2 extends Vector {\n        constructor(x = 0, y = 0) {\n            if (x.type && x.type == \"Vector\") super(x);\n            else super([x, y]);\n        }\n        get x() {\n            return this.get(0);\n        }\n        set x(n) {\n            this.set(0, n);\n            return n;\n        }\n        get y() {\n            return this.get(1);\n        }\n        set y(n) {\n            this.set(1, n);\n            return n;\n        }\n        static Zero() {\n            return new Vector2();\n        }\n    }\n    class Vector3 extends Vector {\n        constructor(x = 0, y = 0, z = 0) {\n            if (x.type && x.type == \"Vector\") super(x);\n            else super([x, y, z]);\n        }\n        get x() {\n            return this.get(0);\n        }\n        set x(n) {\n            this.set(0, n);\n            return n;\n        }\n        get y() {\n            return this.get(1);\n        }\n        set y(n) {\n            this.set(1, n);\n            return n;\n        }\n        get z() {\n            return this.get(2);\n        }\n        set z(n) {\n            this.set(2, n);\n            return n;\n        }\n        static Zero() {\n            return new Vector3();\n        }\n        // operatorMul(b) {\n        //     console.log(b);\n        //     if (typeof b === \"number\") {\n        //         let tmp = new Vector([]);\n        //         tmp.array = tmp.array.concat(this.array);\n        //         for (let i in this.array) {\n        //             tmp.array[i] *= b;\n        //         }\n        //         return tmp;\n        //     } else {\n        //         // 叉乘\n        //         // let m = new Matrix(3, 3, [\n        //         //     [new Vector3(1, 0, 0), new Vector3(0, 1, 0), new Vector3(0, 0, 1)]\n        //         // ]);\n        //         let a = new Matrix(this.length, 1, [this.array]);\n        //         console.log(a);\n        //         return null;\n        //     }\n        // }\n    }\n    class Vector4 extends Vector {\n        constructor(x = 0, y = 0, z = 0, w = 1) {\n            if (x.type && x.type == \"Vector\") super(x);\n            else super([x, y, z, w]);\n        }\n        get x() {\n            return this.get(0) / this.w;\n        }\n        set x(n) {\n            this.set(0, n);\n            return n;\n        }\n        get y() {\n            return this.get(1) / this.w;\n        }\n        set y(n) {\n            this.set(1, n);\n            return n;\n        }\n        get z() {\n            return this.get(2) / this.w;\n        }\n        set z(n) {\n            this.set(2, n);\n            return n;\n        }\n        get w() {\n            return this.get(3);\n        }\n        set w(n) {\n            this.set(3, n);\n            return n;\n        }\n        static Zero() {\n            return new Vector4();\n        }\n    }\n\n    /** todo 矩阵类 */\n    class Matrix extends See3D.LibraryDefineObject {\n        constructor(w, h, fill = 0) {\n            super(\"Matrix\");\n            this.array = [];\n            if (w.type && w.type == \"Matrix\") {// 复制构造函数\n                this.__w = w.w;\n                this.__h = w.h;\n                for (let i = 0; i < this.__h; i++) {\n                    this.array.push([]);\n                    for (let j = 0; j < this.__w; j++) {\n                        this.array[i].push(w.array[i][j]);\n                    }\n                }\n            } else {\n                this.__w = w;\n                this.__h = h;\n                for (let i = 0 ;i < h; i++) {\n                    this.array.push([]);\n                    for (let j = 0; j < w; j++) {\n                        if (typeof fill === \"number\")\n                            this.array[i].push(fill);\n                        else\n                            this.array[i].push(fill[i][j]);\n                    }\n                }\n            }\n        }\n        get w() {\n            return this.__w;\n        }\n        get h() {\n            return this.__h;\n        }\n        T() {\n            let matrix = new Matrix(this.__h, this.__w);\n            for (let i = 0 ;i < this.__w; i++) {\n                for (let j = 0; j < this.__h; j++) {\n                    matrix.array[i][j] = this.array[j][i];\n                }\n            }\n            return matrix;\n        }\n        size() {\n            return new Vector2(this.__w, this.__h);\n        }\n        get(i, j) {\n            return this.array[i][j];\n        }\n        set(i, j, v) {\n            this.array[i][j] = v;\n            return this;\n        }\n        operatorAdd(b) {\n            // console.log(this.size() == b.size());\n            if (this.size() != b.size()) {\n                console.error(new Error(\"Error 100: Matrix size does not match\"));\n                return null;\n            }\n            let c = new Matrix(this.w, this.h, this.array);\n            for (let i = 0; i < this.h; i++) {\n                for (let j = 0; j < this.w; j++) {\n                    c.array[i][j] += b.array[i][j];\n                }\n            }\n            return c;\n        }\n        operatorSub(b) {\n            // console.log(this.size() == b.size());\n            if (this.size() != b.size()) {\n                console.error(new Error(\"Error 100: Matrix size does not match\"));\n                return null;\n            }\n            let c = new Matrix(this.w, this.h, this.array);\n            for (let i = 0; i < this.h; i++) {\n                for (let j = 0; j < this.w; j++) {\n                    c.array[i][j] -= b.array[i][j];\n                }\n            }\n            return c;\n        }\n        operatorMul(b) {\n            // console.log(this.size() == b.size());\n            if (typeof b == \"object\") {\n                if (this.w != b.h) {\n                    console.error(new Error(\"Error 100: Matrix size does not match\"));\n                    return null;\n                }\n                let n = this.w;\n                let c = new Matrix(this.h, b.w, 0);\n                for (let i = 0; i < this.h; i++) {\n                    for (let j = 0; j < b.w; j++) {\n                        let sum = 0;\n                        for (let k = 0; k < n; k++) {\n                            sum += this.array[i][k] * b.array[k][j];\n                        }\n                        c.array[i][j] = sum;\n                    }\n                }\n                return c;\n            } else {\n                let c = new Matrix(this.w, this.h, [].concat(this.array));\n                for (let i = 0; i < this.h; i++) {\n                    for (let j = 0; j < this.w; j++) {\n                        c.array[i][j] *= b;\n                    }\n                }\n                return c;\n            }\n        }\n        static identity(s) {\n            let matrix = new Matrix(s, s);\n            for (let i = 0; i < s; i++) {\n                matrix.array[i][i] = 1;\n            }\n            return matrix;\n        }\n        static Zero(w, h) {\n            return new Matrix(w, h);\n        }\n    }\n    class Matrix2x2 extends Matrix {\n        constructor(fill) {\n            super(2, 2, fill);\n        }\n        inverse() {\n            let tmp = 1 / this.det();\n            let c = new Matrix2x2([[this.array[1][1], -this.array[0][1]], [-this.array[1][0], this.array[0][0]]]);\n            c = c * tmp;\n            return c;\n        }\n        det() {\n            return this.array[0][0] * this.array[1][1] + this.array[0][1] * this.array[1][0];\n        }\n    }\n\n    /** todo 直线类 */\n    // 表示方法: 参数化直线\n    // 即: 起点, 终点, 方向\n    // p(x, y, z) = p0 + v_ * t\n    // t ∈ [-∞, +∞]\n    class Parmline2D extends See3D.LibraryDefineObject {\n        constructor(v0, v1) {\n            super(\"Parmline\");\n            this.p0 = new Vector2(v0);\n            this.p1 = new Vector2(v1);\n            this.v = new Vector2(v1 - v0);\n            this.v_ = this.v.norm();\n        }\n    }\n    class Parmline3D extends See3D.LibraryDefineObject {\n        constructor(v0, v1) {\n            super(\"Parmline\");\n            this.p0 = new Vector3(v0);\n            this.p1 = new Vector3(v1);\n            this.v = new Vector3(v1 - v0);\n            this.v_ = this.v.norm();\n        }\n    }\n\n    /** todo 平面类 */\n    // 表示方法: 点-法线形式\n    // a * (x - x0) + b * (y - y0) + c * (z - z0) = 0\n    // 或\n    // a * x + b * y + c * z + (-a * x0 - b * y0 - c * z0) = 0\n    class Plane3D extends See3D.LibraryDefineObject {\n        constructor(n, p0) {\n            super(\"Plane\");\n            this.n = new Vector3(n);// 法线向量\n            this.p0 = new Vector3(p0);// 平面上一点\n        }\n    }\n\n\n    /** todo 平面分割3D空间, 判断点位于哪个半空间中, -1为负半空间, 0为平面上, 1为正半空间 */\n    function PointPositionWithPlane(point, plane) {\n        let a = plane.n.x, b = plane.n.y, c = plane.n.z;\n        let hs = a * (point.x - plane.p0.x) + b * (point.y - plane.p0.y) + c * (point.z - plane.p0.z);\n        if (hs > 0) return 1;\n        if (hs < 0) return -1;\n        return 0;\n    }\n\n\n    /** todo 计算两参数化2D线段的交点 */\n    function intersParmlines2D(pl1, pl2) {\n        let p0 = pl1.p0;\n        let p2 = pl2.p0;\n        let a = p0.x, b = p0.y, c = p2.x, d = p2.y;\n        let p0v = pl1.v;\n        let p2v = pl2.v;\n        let e = p0v.x, f = p0v.y, g = p2v.x, h = p2v.y;\n        // console.log(a, b, c, d, e, f, g, h);\n        let t1 =\n            (h * (c - a) - g * (d - b))\n            /\n            (h * e - g * f)\n        ;\n        // let t2 =\n        //     (-c + a + e * t1)\n        //     /\n        //     g\n        // ;\n        let x = a + e * t1;\n        let y = b + f * t1;\n        return new Vector2(x, y);\n    }\n    /** todo 计算两参数化3D线段的交点 */\n    function intersParmlines3D(pl1, pl2) {\n        let p0 = pl1.p0;\n        let p2 = pl2.p0;\n        let a = p0.x, b = p0.y, c = p2.x, d = p2.y;\n        let p0v = pl1.v;\n        let p2v = pl2.v;\n        let e = p0v.x, f = p0v.y, g = p2v.x, h = p2v.y;\n        // console.log(a, b, c, d, e, f, g, h);\n        let t1 =\n            (h * (c - a) - g * (d - b))\n            /\n            (h * e - g * f)\n        ;\n        // let t2 =\n        //     (-c + a + e * t1)\n        //     /\n        //     g\n        // ;\n        let x = a + e * t1;\n        let y = b + f * t1;\n        let z = p0.z + p0v.z * t1;\n        return new Vector3(x, y, z);\n    }\n\n    const tInterval = new Interval(\"[0, 1]\");\n\n    /** todo 计算参数化直线与平面的交点 */\n    function intersParmlinePlane(plane, parmline) {\n        // console.log(parmline);\n        let {x: x0, y: y0, z: z0} = parmline.p0;\n        let {x: vx, y: vy, z: vz} = parmline.v;\n        let {x: a, y: b, z: c} = plane.n;\n        let d = -a * x0 - b * y0 - c * z0;\n        let t =\n            -(a * x0 + b * y0 + c * z0 + d)\n            /\n            (a * vx + b * vy + c * vz)\n        ;\n        let x = x0 * vx * t;\n        let y = y0 * vy * t;\n        let z = z0 * vz * t;\n        return new Vector3(x, y, z);\n    }\n    /** todo 计算参数化线段与平面的交点 */\n    function intersSegmentPlane(parmline, plane) {\n        let {x: x0, y: y0, z: z0} = parmline.p0;\n        let {x: vx, y: vy, z: vz} = parmline.v;\n        let {x: a, y: b, z: c} = plane.n;\n        let d = -a * x0 - b * y0 - c * z0;\n        let t =\n            -(a * x0 + b * y0 + c * z0 + d)\n            /\n            (a * vx + b * vy + c * vz)\n        ;\n        if (!tInterval.have(t)) return null;\n        let x = x0 * vx * t;\n        let y = y0 * vy * t;\n        let z = z0 * vz * t;\n        return new Vector3(x, y, z);\n    }\n\n    /** todo 提供四元数类 */\n    class Quaternion extends See3D.LibraryDefineObject {\n        constructor(q0 = 0, q1 = 0, q2 = 0, q3 = 0) {\n            super(\"Quaternion\");\n            this.q0 = q0;\n            if (typeof q0 == \"object\" && arguments.length == 1) {// 复制构造函数\n                let q = q0;\n                this.q0 = q.q0;\n                this.qv = new Vector3(q.qv);\n            } else if (arguments.length == 2) {\n                this.qv = new Vector3(q1);\n            } else {\n                this.qv = new Vector3(q1, q2, q3);\n            }\n        }\n        operatorAdd(b) {\n            return new Quaternion(this.q0 + b.q0, this.qv + b.qv);\n        }\n        operatorSub(b) {\n            return new Quaternion(this.q0 - b.q0, this.qv - b.qv);\n        }\n        operatorMul(q) {\n            let p = this;\n            // let a = p.q0 * q.qv;\n            // let b = q.q0 * p.qv;\n            // let c = p.qv * q.qv;\n            let r = new Quaternion(\n                p.q0 * q.q0 - (p.qv % q.qv),\n                (q.qv * p.q0 + p.qv * q.q0 + p.qv * q.qv)\n            );\n            // console.log((p.q0 * q.qv + q.q0 * p.qv + p.qv * q.qv));\n            return r;\n        }\n        operatorDiv(b) {\n            if (typeof b == \"number\") {\n                let q = new Quaternion(this);\n                q.q0 /= b;\n                q.qv = q.qv / b;\n                return q;\n            }\n        }\n        inverse() {// 加法逆元素\n            return new Quaternion(-this.q0, -this.qv.x, -this.qv.y, -this.qv.z);\n        }\n        conjugate() {// 共轭四元数\n            return new Quaternion(this.q0, -this.qv.x, -this.qv.y, -this.qv.z);\n        }\n        mod() {\n            return Math.sqrt(\n                this.q0 * this.q0 +\n                this.qv.x * this.qv.x +\n                this.qv.y * this.qv.y +\n                this.qv.z * this.qv.z\n            );\n        }\n        mod2() {// 范数平方\n            return this.q0 * this.q0 +\n                this.qv.x * this.qv.x +\n                this.qv.y * this.qv.y +\n                this.qv.z * this.qv.z;\n        }\n        norm() {\n            return this / this.mod();\n        }\n        reciprocal() {\n            return this.conjugate() / this.mod2();\n        }\n        static One() {// 乘法恒等元\n            return new Quaternion(1);\n        }\n        static Zero() {// 加法恒等元\n            return new Quaternion();\n        }\n    }\n\n    // 在库中定义所有的接口\n    lib.define(\"smallest\", smallest);\n    lib.define(\"smallestLen\", smallestLen);\n    lib.define(\"probably\", probably);\n\n    lib.define(\"Enum\", Enum);\n    lib.define(\"MathSet\", MathSet);\n    lib.define(\"Interval\", Interval);\n\n    lib.define(\"Vector\", Vector);\n    lib.define(\"Vector2\", Vector2);\n    lib.define(\"Vector3\", Vector3);\n    lib.define(\"Vector4\", Vector4);\n\n    lib.define(\"Matrix\", Matrix);\n    lib.define(\"Matrix2x2\", Matrix2x2);\n\n    lib.define(\"Parmline2D\", Parmline2D);\n    lib.define(\"Parmline3D\", Parmline3D);\n    lib.define(\"Plane3D\", Plane3D);\n    lib.define(\"PointPositionWithPlane\", PointPositionWithPlane);\n    lib.define(\"intersParmlines2D\", intersParmlines2D);\n    lib.define(\"intersParmlines3D\", intersParmlines3D);\n    lib.define(\"intersParmlinePlane\", intersParmlinePlane);\n    lib.define(\"intersSegmentPlane\", intersSegmentPlane);\n\n    lib.define(\"Quaternion\", Quaternion);\n\n    lib.trans();// 在库的全局添加接口\n    See3D.library(lib);// 将库加载入See3D中\n    See3D.load(\"Math3D\");// 将库加入See3D的默认加载队列\n    if (See3D.DEBUG) See3D.loadGlobal(\"Math3D\");\n    if (See3D.DEBUG) lib.global();\n    See3D.lib(\"Math3D\");\n}();"]}