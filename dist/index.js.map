{"version":3,"sources":["../src/index.js"],"names":["See3D","dom","document","createElement","__dom","__ctx","getContext","loadGlobal","bindLibrary","sout","IO","sostream","__scenes","use","w","width","height","window","innerWidth","innerHeight","s","name","n","render","noView","PhyFun","ViewFun","self","requestAnimationFrame","cb","ctx","clearRect","beginPath","fillStyle","fillRect","textAlign","font","fillText","closePath","__loads","i","load","lib","defines","__libraries","get","entry","console","log","set","push","globalThis","version","DEBUG","Map","Library","val","private","error","Error","LibraryDefineObject","type","checkType","obj","translate","transType"],"mappings":"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","file":"index.js","sourcesContent":["/*!\n\n * See3D 3D Rendering Engine Library\n\n * yhzheng - v0.0.1 (Wed Feb 27 2019 22:22:36 GMT+0800)\n\n * https://github.com/qianduanXIAOHAOZI/see3D/tree/master | Released under MIT license\n\n */\n/**\n * @file index.js\n * @overview 提供整体接口\n */\n\n// const DEBUG = true;\n\n/**\n * @class See3D\n * @constructor\n * @desc See3D类是可以将一个canvas变为See3D画布的类，一切操作都依靠它 \\n\n * 也是所有See3D API的容器，相当于一个module\n */\nclass See3D {\n    constructor(dom = document.createElement(\"canvas\")) {\n        this.__dom = dom;\n        this.__ctx = dom.getContext(\"2d\");\n        this.loadGlobal();\n        this.bindLibrary(\"IO\");\n        this.bindLibrary(\"Math3D\");\n        this.sout = new See3D.IO.sostream(this);\n        this.__scenes = {};\n        this.use = null;\n    }\n    width(w) {\n        if (w === void(0)) {\n            return this.__dom.width;\n        }\n        this.__dom.width = w;\n        return this;\n    }\n    height(w) {\n        if (w === void(0)) {\n            return this.__dom.height;\n        }\n        this.__dom.height = w;\n        return this;\n    }\n    full() {\n        this\n            .width(window.innerWidth)\n            .height(window.innerHeight)\n        ;\n        return this;\n    }\n    push(s) {\n        this.__scenes[s.name] = s;\n        if (!this.use) this.use = s;\n        return this;\n    }\n    scene(n) {\n        this.use = this.__scenes[n];\n        return this;\n    }\n    render() {\n        if (this.use) {\n            this.use.render();\n        } else {\n            this.noView();\n        }\n        return this;\n    }\n    renderLoop(PhyFun, ViewFun) {\n        let self = this;\n        requestAnimationFrame(function cb() {\n            if (PhyFun) PhyFun();// 物理\n            let {width, height} = self.dom;\n            self.ctx.clearRect(0, 0, width, height);\n            self.render();\n            if (ViewFun) ViewFun();// 视角\n            requestAnimationFrame(cb);\n        });\n    }\n    noView() {\n        let ctx = this.ctx;\n        let {width, height} = this.dom;\n        ctx.beginPath();\n        ctx.fillStyle = \"#333\";\n        ctx.fillRect(0, 0, width, height);\n        ctx.fillStyle = \"#fff\";\n        ctx.textAlign = \"center\";\n        ctx.font = \"50px Georgia\";\n        ctx.fillText(\"No View\", width / 2, height / 2);\n        ctx.closePath();\n        return this;\n    }\n    /**\n     * @function loadGlobal\n     * @desc 将所有全局库加载入该See3D实例\n     */\n    loadGlobal() {\n        for (let i of See3D.__loads) {\n            this.load(i);\n        }\n        return this;\n    }\n    bindLibrary(name) {// 将该库的所有API加入该See3D实例\n        let lib = this[name];\n        for (let i in lib.defines) {\n            this[i] = lib.defines[i];\n        }\n    }\n    /**\n     * @function load\n     * @param {string} name\n     * @desc 加载指定库到See3D对象中\n     */\n    load(name) {\n        this[name] = See3D.__libraries.get(name);\n        return this;\n    }\n    get dom() {\n        return this.__dom;\n    }\n    get ctx() {\n        return this.__ctx;\n    }\n    /**\n     * @function library\n     * @param {See3D.Library} entry\n     * @desc 添加See3D库\n     */\n    static library(entry) {\n        // entry\n        console.log(\"%cSee3D library %s loaded.\", \"color:#FF1493\", entry.name);\n        See3D.__libraries.set(entry.name, entry);\n    }\n    /**\n     * @function load\n     * @param {String} name\n     * @desc 添加应默认自带的库\n     */\n    static load(name) {\n        console.log(\"%cSee3D library %s added to See3D global.\", \"color:#C71585\", name);\n        See3D.__loads.push(name);\n    }\n    /**\n     * @function loadGlobal\n     * @param {String} name\n     * @desc 将该库导入到全局环境\n     */\n    static loadGlobal(name) {\n        globalThis[name] = See3D.__libraries.get(name);\n    }\n    static lib(name) {\n        See3D[name] = See3D.__libraries.get(name);\n        return See3D.__libraries.get(name);\n    }\n}\n\n!function (See3D) {\n    See3D.version = \"v0.0.1\";\n    console.log(\"See3D engine (%s) launched\", See3D.version);\n    See3D.DEBUG = true;\n    /**\n     * @property\n     * @private\n     */\n    See3D.__libraries = new Map();\n    /**\n     * @property\n     * @private\n     */\n    See3D.__loads = [];\n\n    /**\n     * @class Library\n     * @constructor\n     * @desc Library类提供了制作See3D类的接口\n     */\n    class Library {\n        constructor(name) {\n            this.name = name;\n            this.defines = {};\n        }\n        define(name, val) {\n            this.defines[name] = val;\n            return this;\n        }\n        get(name) {\n            if (this.defines[name].private) {\n                console.error(new Error(\"Error 99: It's a private value\"));\n            }\n            return this.defines[name];\n        }\n        trans() {\n            for (let i in this.defines) {\n                this[i] = this.defines[i];\n            }\n        }\n        toSee3D() {\n            for (let i in this.defines) {\n                See3D[i] = this.defines[i];\n            }\n        }\n        global() {\n            for (let i in this.defines) {\n                globalThis[i] = this.defines[i];\n            }\n        }\n    }\n    // 所有的See3D库类接口都必须继承自该类\n    class LibraryDefineObject {\n        constructor(type) {\n            this.type = type;\n        }\n        transType() {\n            return null;\n        }\n    }\n    function checkType(obj, type) {\n        return obj.type == type;\n    }\n    function translate(type, obj) {\n        return obj.transType(type);\n    }\n    See3D.Library = Library;\n    See3D.LibraryDefineObject = LibraryDefineObject;\n    See3D.checkType = checkType;\n    See3D.translate = translate;\n}(See3D);"]}