{"version":3,"sources":["../src/index.js"],"names":["See3D","dom","document","createElement","__dom","__ctx","getContext","use","__fps","end","alpha","FOV_x","beta","FOV_y","__BGC","defaultBGC","showFPS","clear","w","width","height","window","innerWidth","innerHeight","s","game","ctx","beginPath","fillStyle","fillRect","closePath","save","translate","render","restore","noView","up1","up2","preFPS","startTS","Date","getTime","endTS","updatePreFPS","requestAnimationFrame","cb","parseInt","fps","font","textBaseline","fillText","bind","textAlign","href","xml","XMLHttpRequest","ActiveXObject","open","send","onreadystatechange","readyState","status","responseText","type","source","sendAjax","content","lines","split","modelInfoLine","modelInfoLineSplits","name","vertexCount","Number","planeCount","points","planes","forEach","value","index","array","version","console","log","DEBUG","Library","val","i","globalThis","Math","PI"],"mappings":"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","file":"index.js","sourcesContent":["/*!\n\n * See3D 3D Rendering Engine Library\n\n * yhzheng - v0.0.1 (Wed Feb 27 2019 22:22:36 GMT+0800)\n\n * https://github.com/qianduanXIAOHAOZI/see3D/tree/master | Released under MIT license\n\n */\n/**\n * @file index.js\n * @overview 提供整体接口\n */\n\n// const DEBUG = true;\n\n/**\n * @class See3D\n * @constructor\n * @desc See3D类是可以将一个canvas变为See3D画布的类，一切操作都依靠它 \\n\n * 也是所有See3D API的容器，相当于一个module\n */\nclass See3D {\n    constructor(dom = document.createElement(\"canvas\")) {\n        this.__dom = dom;\n        this.__ctx = dom.getContext(\"2d\");\n        this.use = null;\n        this.__fps = 0;\n        this.end = true;\n        this.alpha = See3D.FOV_x;\n        this.beta = See3D.FOV_y;\n        // this.alpha = this.beta = Math.max(this.alpha * this.height() / this.width(), this.alpha);\n        // this.__time = 0;\n        this.__BGC = See3D.defaultBGC;\n        this.showFPS = false;\n        this.clear = true;\n    }\n    get ctx() { return this.__ctx; }\n    get dom() { return this.__dom; }\n    width(w) {\n        if (w === void(0)) {\n            return this.__dom.width;\n        }\n        this.__dom.width = w;\n        // this.alpha = this.beta = Math.max(this.alpha * this.height() / this.width(), this.alpha);\n        return this;\n    }\n    height(w) {\n        if (w === void(0)) {\n            return this.__dom.height;\n        }\n        this.__dom.height = w;\n        // this.alpha = this.beta = Math.max(this.alpha * this.height() / this.width(), this.alpha);\n        return this;\n    }\n    full() {\n        this\n            .width(window.innerWidth)\n            .height(window.innerHeight)\n        ;\n        return this;\n    }\n    resize() {\n        this\n            .width(window.innerWidth)\n            .height(window.innerHeight)\n        ;\n    }\n    scene(s) {\n        this.use = s;\n        s.game = this;\n        return this;\n    }\n    render() {\n        if (this.clear) {\n            // console.log(\"clear\");\n            this.ctx.beginPath();\n            this.ctx.fillStyle = this.__BGC;\n            this.ctx.fillRect(0, 0, this.dom.width, this.dom.height);\n            this.ctx.closePath();\n        }\n        this.ctx.save();\n        this.ctx.translate(this.dom.width / 2, this.dom.height / 2);\n        if (this.use) {\n            this.use.render();\n            this.ctx.restore();\n        } else {\n            this.ctx.restore();\n            this.noView();\n        }\n        return this;\n    }\n    whileRender(up1, up2) {\n        let preFPS = 60;\n        this.__fps = 60;\n        let startTS = (new Date()).getTime(), endTS;\n        let updatePreFPS = startTS;\n        window.requestAnimationFrame(function cb() {\n            if (up1) up1();\n            this.render();\n            if (up2) up2();\n            endTS = (new Date()).getTime();\n            this.__fps = parseInt(1000 / (endTS - startTS));\n            if (endTS - updatePreFPS >= 100) {\n                preFPS = this.fps;\n                updatePreFPS = endTS;\n            }\n            this.ctx.fillStyle = \"#fff\";\n            this.ctx.font = \"20px monospace\";\n            this.ctx.textBaseline = \"top\";\n            this.ctx.fillText(\"FPS: \" + preFPS, this.dom.width - 100, 0);\n            startTS = endTS;\n            window.requestAnimationFrame(cb.bind(this));\n        }.bind(this));\n    }\n    noView() {\n        let ctx = this.ctx;\n        let {width, height} = this.dom;\n        ctx.beginPath();\n        ctx.fillStyle = this.__BGC;\n        ctx.fillRect(0, 0, width, height);\n        ctx.fillStyle = \"#fff\";\n        ctx.textAlign = \"center\";\n        ctx.font = \"50px Georgia\";\n        ctx.fillText(\"No View\", width / 2, height / 2);\n        ctx.closePath();\n        return this;\n    }\n    static sendAjax(href, cb) {\n        let xml = null;\n        if (window.XMLHttpRequest) xml = new XMLHttpRequest();\n        else xml = new ActiveXObject('Microsoft.XMLHTTP');\n        xml.open(\"get\", href, true);\n        xml.send();\n        xml.onreadystatechange = function() {\n            if (xml.readyState == 4 && xml.status == 200) {\n                cb(xml.responseText);\n            }\n        }\n    }\n    static loadModel(type, source) {\n        this.sendAjax(source, (content) => {\n            let lines = content.split(\"\\n\");\n            let modelInfoLine = lines[0];\n            let modelInfoLineSplits = modelInfoLine.split(\" \");\n            let name = modelInfoLineSplits[0], vertexCount = Number(modelInfoLineSplits[1]), planeCount = Number(modelInfoLineSplits[2]);\n            let points = [];\n            let planes = [];\n            lines.forEach(((value, index, array) => {\n            }));\n        });\n    }\n    get fps() { return this.__fps; }\n}\n\n!function (See3D) {\n    See3D.version = \"v0.0.1\";\n    console.log(\"See3D engine (%s) launched\", See3D.version);\n    See3D.DEBUG = true;\n\n    /**\n     * @class Library\n     * @constructor\n     * @desc Library类提供了制作See3D类的接口\n     */\n    class Library {\n        constructor(name) {\n            this.name = name;\n        }\n        define(name, val) {\n            this[name] = val;\n            return this;\n        }\n        toSee3D() {\n            See3D[this.name] = this;\n        }\n        global() {\n            for (let i in this) {\n                globalThis[i] = this[i];\n            }\n        }\n    }\n    See3D.Library = Library;\n\n    // 设置See3D视野角度\n    See3D.FOV_x = Math.PI / 180 * 120;\n    See3D.FOV_y = Math.PI / 180 * 120;\n\n    // 设置See3D默认背景颜色\n    See3D.defaultBGC = \"#33334a\";\n}(See3D);"]}